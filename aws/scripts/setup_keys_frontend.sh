#!/bin/bash
# Script to set up SSH keys on the Frontend VM (10.0.8.49)

# Create .ssh directory if it doesn't exist
mkdir -p ~/.ssh
chmod 700 ~/.ssh

# Add public keys of all other VMs to authorized_keys
cat >> ~/.ssh/authorized_keys << 'EOT'
# Database VM (10.0.10.169) public key
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQCoGWc7RIlNHaiqfZiZ7HPSmUDy8jnpCQE8xlUKeJwXXWsdvDFw08Lz7IoTVZFmJ6far94dXU5ixV/AV/+OTwxbtscIW1c1BrBS2KMWOHpR+oX+EBCAHxpx9nC5RuTDicStmyQ26UX+H1yhI/q+GfTlVdnHe3AQDujiZpzh0LkFJscphR0L7B3mGXHawz26ADVhopJHLcaPTivwIzdFHnfUfYM4HkvkMOsGK9Xy/NoeR4PP6urtYeUZf0Tixo0OVncefGsIm0SuM8jpdRuJyoEsYcI/qhy3Bsjp1jQ36KD+ws9QDjjlRbUR+UiIdRdUxelKtyC0o8RoVHmX4/gueLBmuZo2MSVdfnz8NVYIXvWx4ulwIhqerQQrEYBnzGO0BO0ruqGhUEpxoEHbybxgYcuVphkQBBrEEMFxUdZHF3cRDOKrMMSzLYm4AyY+HnkUEzXxJantJTSlSwG1jbudDZiPhrT70Ovwspk48NK/18qy0dFO9XmIwz6NLKuJzPUIqsxXMQ1651lFAFchQgkqjt0pbAsvgrbTti32p51BpOZYI4NDTl3EF2rcCQoonJA6HBQY21BBIBXhdbZYZ/RQKdqFPzljGpnipuFNVrNm8sU0O429qwDUFuIvEa9R9DO4GWE4MhCPsHH31Gybh4x79UyVrwMUOVm4b/gEnVugJHdxlw== ubuntu@ip-10-0-10-169

# Backend VM (10.0.0.22) public key
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQDQ+ZTfbXWCLJzKdX8M08C7UomHBZFPAXpFAYT9CeJOYSpahJ45SzuMyANDgcsI/H5vVpgkvPUjdsztwv66qvL3M/2Zli5C9wjkUZtWtZibn+0ojWDQufhMmCK6Q4zZbCxGKy1utGaOPVlOqp+ZQA2VjNNBzS4qk6U2/6Tfv647pHSPa/vkV1tHB8Q2wYwZY4eAJC2v5gD6T8P8yJ1wb89Z3MR0aDeUPSFRVJM6ReM+qn36u5ZByYR/+b6qwoobgbNM6WFnb2m4YDZspfx3uf3EPdV41aQpq/7EhDAoKTwSakZEudQNLB34cqJa+n8oG/WFE46gsVoq0X3COpEv8fzxLfWtjdXqCxb1ON5S1FVQGQ4VFyOZEsYBcdHs1kXVRaeMygQ+JjbGZw5gC9Dj7jyqa8foaQj8KyvR042zeWCdx1RfMZJ+bhbotTctzfs1j211nfKEx3nK2s4ADjC+xHhsW019xdpte4o5ames7wqCuCGsPQmvCPEnecQTr++SBQHsdJXjmjZU3+Z1LzGpJqSjD51F2e0wSIzHOCUWdeEKtcidqBW7e8NEnlw03hiwXuM5JCbWonEIM+gr3jbNJRL+5xck7o0cq8/v73f6P/exFA1exkM2GvHOK6smJgw41OimGZmpC2jmQAfeMVYt6gopKdF/b6XqF7CEbbQF8jEZew== ubuntu@ip-10-0-13-3

# Messaging VM (10.0.0.21) public key
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQCf0J2Tg9a9bhMIEQTV9zEiGVlZ3lwpJZDfI2VokbPFiSyo5l5Y+baW3+icv/jwN7tm+HkcIn1nnE+jZSz6jsFNa2RN8vSesW7ItndiAqC9NNd7QtUxbvV1wzmGiUm/rwLiXHEHmj/mCer0L9kWmRLiJqVllifWHWqmSbVGa3AIsgx7rdn3ayV08lQPDHXXXRDy5f5hsgOg6yOUsi/X4X9wtFVUq5mDP51t7D5Phr3zKWsCgkfm3d20CIlcP178bCvCM4cegoreXjartA+VKC9fTLOCdrkjq8hl1V4z0E6gRex+0dKm9JjcQ4W0eK8oCBdtrdD5vocWRjPsFEvS26hGsTYIzuUKFWjVX1PkejElsFMG1E8jh7zahJiWH0X5/FENlGVc+JIAO3rVlQ3ImD2YquuxCUHrK3Gd0TteuN/I5/NukpwycD0n37GS1T5lzFI0UjWBk3/sDV2y+E+snEBOEIvpePB+TdOewy0DdCqNNuwjAMBag6DDBZphc81XFkf60abmyqy803rg6OfjRna0dCyi3g7jd2q0eBcjZPRsRFAI+yZJX9U6HtuUPzkRjbs/dofGAMX9Tg2s1IM8kR+XZs7rA0aX9HxprGAL7l8C6PCFq/YwO8X0jiHCXu6UxLwDoHp+lSSeKWrCcobvphVUYpbR5zppoL9i+NVRLOk6Nw== ubuntu@ip-10-0-0-21
EOT

# Set proper permissions on authorized_keys
chmod 600 ~/.ssh/authorized_keys

echo "SSH keys for other VMs have been added to authorized_keys on Frontend VM"
