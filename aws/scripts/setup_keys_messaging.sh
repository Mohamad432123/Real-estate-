#!/bin/bash
# Script to set up SSH keys on the Messaging VM (10.0.0.21)

# Create .ssh directory if it doesn't exist
mkdir -p ~/.ssh
chmod 700 ~/.ssh

# Add public keys of all other VMs to authorized_keys
cat >> ~/.ssh/authorized_keys << 'EOT'
# Database VM (10.0.10.169) public key
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQCoGWc7RIlNHaiqfZiZ7HPSmUDy8jnpCQE8xlUKeJwXXWsdvDFw08Lz7IoTVZFmJ6far94dXU5ixV/AV/+OTwxbtscIW1c1BrBS2KMWOHpR+oX+EBCAHxpx9nC5RuTDicStmyQ26UX+H1yhI/q+GfTlVdnHe3AQDujiZpzh0LkFJscphR0L7B3mGXHawz26ADVhopJHLcaPTivwIzdFHnfUfYM4HkvkMOsGK9Xy/NoeR4PP6urtYeUZf0Tixo0OVncefGsIm0SuM8jpdRuJyoEsYcI/qhy3Bsjp1jQ36KD+ws9QDjjlRbUR+UiIdRdUxelKtyC0o8RoVHmX4/gueLBmuZo2MSVdfnz8NVYIXvWx4ulwIhqerQQrEYBnzGO0BO0ruqGhUEpxoEHbybxgYcuVphkQBBrEEMFxUdZHF3cRDOKrMMSzLYm4AyY+HnkUEzXxJantJTSlSwG1jbudDZiPhrT70Ovwspk48NK/18qy0dFO9XmIwz6NLKuJzPUIqsxXMQ1651lFAFchQgkqjt0pbAsvgrbTti32p51BpOZYI4NDTl3EF2rcCQoonJA6HBQY21BBIBXhdbZYZ/RQKdqFPzljGpnipuFNVrNm8sU0O429qwDUFuIvEa9R9DO4GWE4MhCPsHH31Gybh4x79UyVrwMUOVm4b/gEnVugJHdxlw== ubuntu@ip-10-0-10-169

# Frontend VM (10.0.8.49) public key
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQCI/YkgM4iBgPo7BfB6OUPQSxLH6XNUSsnQEL8j2o+rm7ubIlq6GDpC9zb5uLIALIbh0rf0fdrJRqKeTErkKapJBNZu4MQ/+IuC3kxsDhzZsGHSGLyHQjcX/5hyOJ6UWNEu9N/06sB/tPv8ux1KdZfwimafRtNxdMbMSuaFvKoQ7tKnGokMpG5cn/6gsx2TGxnD0X3NJAixnD8GeYEN97rlX5zHv/tTp/G8JmEt4QLp2J80080L0TYMNMlGyBv+/wcN966axoLDmhO2aRdRxb8mpdCvCJwVcP0+PPFgnXGD6OH7I2PcJCJbIcwifLyobDaELs23mF6zXYAUeuV7eawWK3EZRknAyrIO6xW0NrG2PHCfOjebh9tu6VHZE/E4pvnvCpz3CUggGYDwn0sotUS1uked5Z8fE5IPEeusGfz5U33uheXLfZSwpCL9EYpuBenPKJYn0ggmX6Vtb2adsaeuA0R1PTcKlkWWhHu2TXEQFY3BaeuyaOLD3nFPwZQ6gjrR4dEjxB4Shuj/9HLbGTWe/Ah8RiGUdFlzNf750Cg3jjB6HG7UR/VjQW3QDEio69OkDUonir+KKcHwy5G60eSTqK7S2aocQ3wJobHpH02D1JdsRCGuZCYOyvkIKZx0w9qIINtl+Nh6vk9im4CXErT0TszaGgPYTYHdZXC4NAD7Kw== gc359@njit.edu

# Backend VM (10.0.0.22) public key
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQDQ+ZTfbXWCLJzKdX8M08C7UomHBZFPAXpFAYT9CeJOYSpahJ45SzuMyANDgcsI/H5vVpgkvPUjdsztwv66qvL3M/2Zli5C9wjkUZtWtZibn+0ojWDQufhMmCK6Q4zZbCxGKy1utGaOPVlOqp+ZQA2VjNNBzS4qk6U2/6Tfv647pHSPa/vkV1tHB8Q2wYwZY4eAJC2v5gD6T8P8yJ1wb89Z3MR0aDeUPSFRVJM6ReM+qn36u5ZByYR/+b6qwoobgbNM6WFnb2m4YDZspfx3uf3EPdV41aQpq/7EhDAoKTwSakZEudQNLB34cqJa+n8oG/WFE46gsVoq0X3COpEv8fzxLfWtjdXqCxb1ON5S1FVQGQ4VFyOZEsYBcdHs1kXVRaeMygQ+JjbGZw5gC9Dj7jyqa8foaQj8KyvR042zeWCdx1RfMZJ+bhbotTctzfs1j211nfKEx3nK2s4ADjC+xHhsW019xdpte4o5ames7wqCuCGsPQmvCPEnecQTr++SBQHsdJXjmjZU3+Z1LzGpJqSjD51F2e0wSIzHOCUWdeEKtcidqBW7e8NEnlw03hiwXuM5JCbWonEIM+gr3jbNJRL+5xck7o0cq8/v73f6P/exFA1exkM2GvHOK6smJgw41OimGZmpC2jmQAfeMVYt6gopKdF/b6XqF7CEbbQF8jEZew== ubuntu@ip-10-0-13-3
EOT

# Set proper permissions on authorized_keys
chmod 600 ~/.ssh/authorized_keys

echo "SSH keys for other VMs have been added to authorized_keys on Messaging VM"
